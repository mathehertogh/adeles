
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ray Class Groups &#8212; Computing with adèles and idèles</title>
    <link rel="stylesheet" href="_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Profinite Functions" href="profinite_function.html" />
    <link rel="prev" title="Idèles" href="idele.html" />
    <link rel="icon" href="_static/sageicon.png" type="image/x-icon" />
    <script src="_static/thebe.js" type="text/javascript"></script>
    <script src="_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="profinite_function.html" title="Profinite Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="idele.html" title="Idèles"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="index.html">Home</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Ray Class Groups</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-adeles.ray_class_group">
<span id="ray-class-groups"></span><h1>Ray Class Groups<a class="headerlink" href="#module-adeles.ray_class_group" title="Permalink to this headline">¶</a></h1>
<p>Class Groups of Number Fields</p>
<p><a class="reference external" href="https://trac.sagemath.org/ticket/15829">Trac-ticket #15829</a> adds (among other
things) ray class groups to SageMath. The ticket is not yet finished and
included into SageMath. It does already contain this file, from Robbert Harron,
implementing ray class groups in SageMath. We use this file to have ray class
groups functionality available for our adèles and idèles package.</p>
<p>We can compute class groups, ray class groups, and <span class="math notranslate nohighlight">\(S\)</span>-class groups of number
fields, and we do so by wrapping the functionality from the PARI C-library. Some
of what can be computed includes the group structure, representative ideals, the
class of a given ideal, generators of the group, and products of elements. This
file also implements moduli of number fields.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Robert Harron (2016-08-15): implemented ray class groups and moduli</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Computations with a ray class group of a quadratic field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">F</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">modulus</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">m</span>
<span class="p">(</span><span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">infinity_0</span> <span class="o">*</span> <span class="n">infinity_1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">m</span><span class="p">);</span> <span class="n">R</span>
<span class="n">Ray</span> <span class="k">class</span> <span class="nc">group</span> <span class="n">of</span> <span class="n">order</span> <span class="mi">8</span> <span class="k">with</span> <span class="n">structure</span> <span class="n">C4</span> <span class="n">x</span> <span class="n">C2</span> <span class="n">of</span> <span class="n">Number</span> <span class="n">Field</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">with</span> <span class="n">defining</span> <span class="n">polynomial</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">40</span> <span class="n">of</span> <span class="n">modulus</span> <span class="p">(</span><span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">infinity_0</span> <span class="o">*</span> <span class="n">infinity_1</span>
</pre></div>
</div>
<p>Unlike for class groups and <span class="math notranslate nohighlight">\(S\)</span>-class groups, ray class group elements
do not carry around a representative ideal (for reasons of efficiency).
Nevertheless, one can be demanded. The returned ideal should be somewhat
‘small.’</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.</span><span class="n">gens_ideals</span><span class="p">()</span>
<span class="p">(</span><span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">430</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">200</span><span class="p">),</span> <span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">c</span>
<span class="n">c0</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">c1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span> <span class="n">c</span>
<span class="n">c0</span><span class="o">^</span><span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span>
<span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">470</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py class">
<dt id="adeles.ray_class_group.Modulus">
<em class="property">class </em><code class="sig-prename descclassname">adeles.ray_class_group.</code><code class="sig-name descname">Modulus</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">finite</span></em>, <em class="sig-param"><span class="n">infinite</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">check</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.Modulus" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.sage_object.SageObject</span></code></p>
<p>Modulus of a number field</p>
<dl class="py method">
<dt id="adeles.ray_class_group.Modulus.equivalent_coprime_ideal_multiplier">
<code class="sig-name descname">equivalent_coprime_ideal_multiplier</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">I</span></em>, <em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.Modulus.equivalent_coprime_ideal_multiplier" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <code class="docutils literal notranslate"><span class="pre">I</span></code> coprime to this modulus <span class="math notranslate nohighlight">\(m\)</span>, return a number field element <span class="math notranslate nohighlight">\(\beta\)</span>
such that <span class="math notranslate nohighlight">\(\beta I\)</span> is coprime to the modulus <code class="docutils literal notranslate"><span class="pre">other</span></code> and equivalent to
<code class="docutils literal notranslate"><span class="pre">I</span></code> <span class="math notranslate nohighlight">\(\mathrm{mod}^\ast m\)</span>; in particular, <span class="math notranslate nohighlight">\(\beta\)</span> will be <span class="math notranslate nohighlight">\(1 \mathrm{mod}^\ast m\)</span>.</p>
<p>EXAMPLES:</p>
<p>An example with two prime factors difference between this modulus and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">m_small</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">modulus</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">m_big</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">modulus</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">m_small</span><span class="o">.</span><span class="n">equivalent_coprime_ideal_multiplier</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">m_big</span><span class="p">)</span>
<span class="mi">109</span><span class="o">/</span><span class="mi">54</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="adeles.ray_class_group.Modulus.equivalent_ideal_coprime_to_other">
<code class="sig-name descname">equivalent_ideal_coprime_to_other</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">I</span></em>, <em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.Modulus.equivalent_ideal_coprime_to_other" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <code class="docutils literal notranslate"><span class="pre">I</span></code> coprime to this modulus <span class="math notranslate nohighlight">\(m\)</span>, return an ideal <span class="math notranslate nohighlight">\(J\)</span> such that <span class="math notranslate nohighlight">\(J\)</span> is coprime
to the modulus <code class="docutils literal notranslate"><span class="pre">other</span></code> and equivalent to <code class="docutils literal notranslate"><span class="pre">I</span></code> <span class="math notranslate nohighlight">\(\mathrm{mod}^\ast m\)</span>.</p>
<p>This is useful for lowering the level of a non-primitive Hecke character.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">I</span></code> – an ideal relatively prime to this modulus (not checked).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – some other modulus.</p></li>
</ul>
<p>OUTPUT:</p>
<p>an ideal coprime to <code class="docutils literal notranslate"><span class="pre">other</span></code> and equivalent to <code class="docutils literal notranslate"><span class="pre">I</span></code> in the ray class
group modulo this modulus.</p>
</dd></dl>

<dl class="py method">
<dt id="adeles.ray_class_group.Modulus.fix_signs">
<code class="sig-name descname">fix_signs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.Modulus.fix_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">self.number_field()</span></code>, find <span class="math notranslate nohighlight">\(b\)</span> congruent to <code class="docutils literal notranslate"><span class="pre">a</span></code> <span class="math notranslate nohighlight">\(mod^\ast\)</span> <code class="docutils literal notranslate"><span class="pre">self.finite_part()</span></code>
such that <span class="math notranslate nohighlight">\(b\)</span> is positive at the infinite places dividing <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="adeles.ray_class_group.RayClassGroup">
<em class="property">class </em><code class="sig-prename descclassname">adeles.ray_class_group.</code><code class="sig-name descname">RayClassGroup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gens_orders</span></em>, <em class="sig-param"><span class="n">names</span></em>, <em class="sig-param"><span class="n">modulus</span></em>, <em class="sig-param"><span class="n">gens</span></em>, <em class="sig-param"><span class="n">bnr</span></em>, <em class="sig-param"><span class="n">proof</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.RayClassGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sage.groups.abelian_gps.abelian_group.AbelianGroup_class</span></code></p>
<p>Ray class group of a number field</p>
<dl class="py attribute">
<dt id="adeles.ray_class_group.RayClassGroup.Element">
<code class="sig-name descname">Element</code><a class="headerlink" href="#adeles.ray_class_group.RayClassGroup.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#adeles.ray_class_group.RayClassGroupElement" title="adeles.ray_class_group.RayClassGroupElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayClassGroupElement</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="adeles.ray_class_group.RayClassGroup.gens_ideals">
<code class="sig-name descname">gens_ideals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.RayClassGroup.gens_ideals" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
<span class="o">....</span><span class="p">:</span>     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="o">....</span><span class="p">:</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
<span class="o">....</span><span class="p">:</span>     <span class="nd">@cached_method</span>
<span class="o">....</span><span class="p">:</span>     <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">....</span><span class="p">:</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="o">^</span><span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
<span class="kc">None</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">()</span>
<span class="mi">4</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cache</span>
<span class="mi">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="adeles.ray_class_group.RayClassGroup.ray_class_field">
<code class="sig-name descname">ray_class_field</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subgroup</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">algorithm</span><span class="o">=</span><span class="default_value">'stark'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.RayClassGroup.ray_class_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Two different algorithms are possible: pari’s
<a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/html/General_number_fields.html#se:bnrstark">bnrstark</a> and
<a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/html/General_number_fields.html#se:rnfkummer">rnfkummer</a>.
The first one uses the Stark conjecture and only deals with totally real
extensions of a totally real base field. The second one uses Kummer
theory and only deals with extensions of prime degree.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>algorithm – (default: <code class="docutils literal notranslate"><span class="pre">stark</span></code>) if the value is <code class="docutils literal notranslate"><span class="pre">stark</span></code>,
then pari’s <code class="docutils literal notranslate"><span class="pre">bnrstark</span></code> function is tried first, and if that
fails, <code class="docutils literal notranslate"><span class="pre">rnfkummer</span></code> will be attempted. If the value is
<code class="docutils literal notranslate"><span class="pre">kummer</span></code>, then pari’s <code class="docutils literal notranslate"><span class="pre">rnfkummer</span></code> is tried first, with
<code class="docutils literal notranslate"><span class="pre">bnrstark</span></code> as a backup. Using <code class="docutils literal notranslate"><span class="pre">stark_only</span></code> or <code class="docutils literal notranslate"><span class="pre">kummer_only</span></code>
will just raise an exception if the first attempt fails.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The class field corresponding to the given subgroup, or the
ray class field if <code class="docutils literal notranslate"><span class="pre">subgroup</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, as a relative
number field.</p>
<p>EXAMPLES:</p>
<p>Class fields of <span class="math notranslate nohighlight">\(\QQ(\sqrt{3})\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">modulus</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.</span><span class="n">ray_class_field</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">Number</span> <span class="n">Field</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">with</span> <span class="n">defining</span> <span class="n">polynomial</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span> <span class="n">over</span> <span class="n">its</span> <span class="n">base</span> <span class="n">field</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">subgroup</span><span class="p">([</span><span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.</span><span class="n">ray_class_field</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">Number</span> <span class="n">Field</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">with</span> <span class="n">defining</span> <span class="n">polynomial</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span> <span class="n">over</span> <span class="n">its</span> <span class="n">base</span> <span class="n">field</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">modulus</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">subgroup</span><span class="p">([</span><span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.</span><span class="n">ray_class_field</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">Number</span> <span class="n">Field</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">with</span> <span class="n">defining</span> <span class="n">polynomial</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">4</span> <span class="n">over</span> <span class="n">its</span> <span class="n">base</span> <span class="n">field</span>
</pre></div>
</div>
<p>An example where pari’s <code class="docutils literal notranslate"><span class="pre">bnrstark</span></code> fails, but <code class="docutils literal notranslate"><span class="pre">rnfkummer</span></code> saves the day:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">36</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">36</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">modulus</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">set_verbose</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">K</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ray_class_field</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">K</span>
<span class="n">verbose</span> <span class="mi">1</span> <span class="p">(</span><span class="o">...</span><span class="p">:</span> <span class="n">class_group</span><span class="o">.</span><span class="n">py</span><span class="p">,</span> <span class="n">ray_class_field</span><span class="p">)</span> <span class="n">bnrstark</span> <span class="n">failed</span><span class="p">;</span> <span class="n">trying</span> <span class="n">rnfkummer</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">Field</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">with</span> <span class="n">defining</span> <span class="n">polynomial</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">11</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">5</span> <span class="n">over</span> <span class="n">its</span> <span class="n">base</span> <span class="n">field</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">set_verbose</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="adeles.ray_class_group.RayClassGroupElement">
<em class="property">class </em><code class="sig-prename descclassname">adeles.ray_class_group.</code><code class="sig-name descname">RayClassGroupElement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parent</span></em>, <em class="sig-param"><span class="n">exponents</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.RayClassGroupElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sage.groups.abelian_gps.abelian_group_element.AbelianGroupElement</span></code></p>
<p>Element of a ray class group</p>
<dl class="py method">
<dt id="adeles.ray_class_group.RayClassGroupElement.ideal">
<code class="sig-name descname">ideal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reduce</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.RayClassGroupElement.ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ideal representing this ray class.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">reduce</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> (by default) the returned ideal is
reduced to ‘small’ (this can be slow on large inputs).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reduce</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) determine whether or not
to output a ‘small’ representative.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An ideal representing this ray class. If <code class="docutils literal notranslate"><span class="pre">reduce</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
the ideal returned is made ‘small’ by the ideal’s
<code class="docutils literal notranslate"><span class="pre">reduce_equiv</span></code> function (and <code class="docutils literal notranslate"><span class="pre">reduce_equiv</span></code> is used at
each step of computing this representative). Otherwise, the
output is just the appropriate product of the powers of the
generators of the ray class group.</p>
<p>EXAMPLES:</p>
<p>Over a real quadratic field field of class number 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">modulus</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">c0</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">c1</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="o">-</span><span class="mi">6242265</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1268055</span><span class="p">)</span>
</pre></div>
</div>
<p>Over a real quadratic field of class number 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">F</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">modulus</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">sage</span><span class="p">:</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">R</span><span class="p">:</span>
<span class="o">...</span>       <span class="k">if</span> <span class="n">R</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ideal</span><span class="p">())</span> <span class="o">!=</span> <span class="n">c</span><span class="p">:</span>
<span class="o">...</span>           <span class="nb">print</span> <span class="s2">&quot;Bug!&quot;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="adeles.ray_class_group.pari_extended_ideal_to_sage">
<code class="sig-prename descclassname">adeles.ray_class_group.</code><code class="sig-name descname">pari_extended_ideal_to_sage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">K</span></em>, <em class="sig-param"><span class="n">Ix</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.pari_extended_ideal_to_sage" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an ‘extended ideal’ in pari format to an ideal in Sage.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> – number field to which the ideal belongs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ix</span></code> – A pair whose first entry is a pari ideal and whose second entry
is a pari factorization matrix representing an algebraic number.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The ideal that is the product of the ideal <code class="docutils literal notranslate"><span class="pre">Ix[0]</span></code> and the principal
ideal generated by <code class="docutils literal notranslate"><span class="pre">Ix[1]</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">pari_extended_ideal_to_sage</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">pari</span><span class="p">([</span><span class="n">I</span><span class="p">,</span> <span class="n">a</span><span class="p">]))</span> <span class="o">==</span> <span class="n">I</span>
<span class="kc">True</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">factorization_matrix</span> <span class="o">=</span> <span class="n">pari</span><span class="p">([</span><span class="n">pari</span><span class="p">([</span><span class="n">pari</span><span class="p">([</span><span class="mi">31</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">Col</span><span class="p">(),</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">Mat</span><span class="p">(),</span> <span class="n">pari</span><span class="p">([</span><span class="n">pari</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Col</span><span class="p">(),</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">Mat</span><span class="p">()])</span><span class="o">.</span><span class="n">Col</span><span class="p">()</span><span class="o">.</span><span class="n">matconcat</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">pari_extended_ideal_to_sage</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">pari</span><span class="p">([</span><span class="n">I</span><span class="p">,</span> <span class="n">factorization_matrix</span><span class="p">]))</span>
<span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="o">-</span><span class="mi">135</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">837</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="mi">4239</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">pari_extended_ideal_to_sage</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">gens_values</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="adeles.ray_class_group.pari_real_places_to_sage">
<code class="sig-prename descclassname">adeles.ray_class_group.</code><code class="sig-name descname">pari_real_places_to_sage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">K</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.pari_real_places_to_sage" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list converting from the ordering of real places in pari to that
of Sage’s <code class="xref py py-func docutils literal notranslate"><span class="pre">places()</span></code>.</p>
<p>EXAMPLES:</p>
<p>A totally real quartic field where the pari and Sage orderings are different.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">defining_polynomial</span><span class="p">()</span>
<span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">24</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">()</span>
<span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">pari_real_places_to_sage</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>A quintic field with three real places.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">pari_real_places_to_sage</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="adeles.ray_class_group.ray_class_group">
<code class="sig-prename descclassname">adeles.ray_class_group.</code><code class="sig-name descname">ray_class_group</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">K</span></em>, <em class="sig-param"><span class="n">modulus</span></em>, <em class="sig-param"><span class="n">proof</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">names</span><span class="o">=</span><span class="default_value">'c'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#adeles.ray_class_group.ray_class_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ray class group modulo <code class="docutils literal notranslate"><span class="pre">modulus</span></code>.</p>
<p>EXAMPLES:</p>
<p>Ray class group of a real quadratic field of class number 1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">modulus</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">29</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">m</span><span class="p">);</span> <span class="n">G</span>
<span class="n">Ray</span> <span class="k">class</span> <span class="nc">group</span> <span class="n">of</span> <span class="n">order</span> <span class="mi">8</span> <span class="k">with</span> <span class="n">structure</span> <span class="n">C4</span> <span class="n">x</span> <span class="n">C2</span> <span class="n">of</span> <span class="n">Number</span> <span class="n">Field</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">with</span> <span class="n">defining</span> <span class="n">polynomial</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span> <span class="n">of</span> <span class="n">modulus</span> <span class="p">(</span><span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">infinity_0</span> <span class="o">*</span> <span class="n">infinity_1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">G</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">G</span><span class="o">.</span><span class="n">gens_ideals</span><span class="p">()</span>
<span class="p">(</span><span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">31</span><span class="p">),</span> <span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">12672</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">G</span><span class="o">.</span><span class="n">gens_orders</span><span class="p">()</span>
<span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Ray class group of an imaginary quadratic field of class number 3.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">));</span> <span class="n">R</span>
<span class="n">Ray</span> <span class="k">class</span> <span class="nc">group</span> <span class="n">of</span> <span class="n">order</span> <span class="mi">6</span> <span class="k">with</span> <span class="n">structure</span> <span class="n">C6</span> <span class="n">of</span> <span class="n">Number</span> <span class="n">Field</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">with</span> <span class="n">defining</span> <span class="n">polynomial</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span> <span class="n">of</span> <span class="n">modulus</span> <span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.</span><span class="n">gens_ideals</span><span class="p">()</span>
<span class="p">(</span><span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.</span><span class="n">modulus</span><span class="p">()</span><span class="o">.</span><span class="n">finite_part</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="mi">8</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">class_group</span><span class="p">()</span><span class="o">.</span><span class="n">gens_ideals</span><span class="p">()</span>
<span class="p">(</span><span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),)</span>
</pre></div>
</div>
<p>Over <span class="math notranslate nohighlight">\(\QQ\)</span>, the ray class group modulo <span class="math notranslate nohighlight">\((m)\infty\)</span> is the unit group of <span class="math notranslate nohighlight">\(\ZZ/m\ZZ\)</span>, while
the ray class group modulo <span class="math notranslate nohighlight">\((m)\)</span> is the latter modulo <span class="math notranslate nohighlight">\(\{\pm1\}\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Q</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">modulus</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">gens_ideals</span><span class="p">()</span>
<span class="p">(</span><span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">31</span><span class="p">),</span> <span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">21</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">unit_gens</span><span class="p">()</span>
<span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Q</span><span class="o">.</span><span class="n">ray_class_group</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span><span class="o">.</span><span class="n">gens_ideals</span><span class="p">()</span>
<span class="p">(</span><span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">21</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="idele.html"
                        title="previous chapter">Idèles</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="profinite_function.html"
                        title="next chapter">Profinite Functions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ray_class_group.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="profinite_function.html" title="Profinite Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="idele.html" title="Idèles"
             >previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="index.html">Home</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Ray Class Groups</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Mathé Hertogh.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>