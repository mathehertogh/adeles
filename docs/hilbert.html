
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hilbert Class Field Computations &#8212; Computing with adèles and idèles</title>
    <link rel="stylesheet" href="_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Shimura Connecting Homomorphism" href="shimura.html" />
    <link rel="icon" href="_static/sageicon.png" type="image/x-icon" />
    <script src="_static/thebe.js" type="text/javascript"></script>
    <script src="_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="shimura.html" title="Shimura Connecting Homomorphism"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="index.html">Home</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Hilbert Class Field Computations</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-adeles.hilbert">
<span id="hilbert-class-field-computations"></span><h1>Hilbert Class Field Computations<a class="headerlink" href="#module-adeles.hilbert" title="Permalink to this headline">¶</a></h1>
<p>Example Hilbert Class Field Computations using Shimura’s Reciprocity Law</p>
<p>Chapter 9 of [Her2021] describes the computation of Hilbert class fields of
quadratic imaginary number fields using Shimura’s reciprocity law. This file
contains three detailed examples of such computations.</p>
<p>Each of these three examples also features in [GS1998]. That paper performs a
very similar computation, except that it translates the idèlic results from
Shimura to statements about ideals, in order to perform their computations using
ideals. In contrast, we will perform the computation using idèles directly,
namely using <a class="reference internal" href="idele.html#adeles.idele.Ideles" title="adeles.idele.Ideles"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ideles</span></code></a> and the related adèlic classes
<a class="reference internal" href="adele.html#adeles.adele.Adeles" title="adeles.adele.Adeles"><code class="xref py py-class docutils literal notranslate"><span class="pre">Adeles</span></code></a> and
<a class="reference internal" href="profinite_number.html#adeles.profinite_number.ProfiniteNumbers" title="adeles.profinite_number.ProfiniteNumbers"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfiniteNumbers</span></code></a>.</p>
<p>REFERENCES:</p>
<ul class="simple">
<li><p>[Her2021] Mathé Hertogh, Computing with adèles and idèles, master’s thesis,
Leiden University, 2021.</p></li>
<li><p>[GS1998] Alice Gee, Peter Stevenhagen, Generating class fields using Shimura
reciprocity, 1998. In: Buhler J.P. (eds) Algorithmic Number Theory. ANTS 1998.
Lecture Notes in Computer Science, vol 1423. Springer, Berlin, Heidelberg.
<a class="reference external" href="https://doi.org/10.1007/BFb0054883">https://doi.org/10.1007/BFb0054883</a></p></li>
</ul>
<div class="section" id="example-1">
<h2>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h2>
<p>The first example will be the computation of the Hilbert class field <span class="math notranslate nohighlight">\(H\)</span> of
<span class="math notranslate nohighlight">\(K = \QQ(\sqrt{-71})\)</span>, using the cube root <span class="math notranslate nohighlight">\(\gamma_2\)</span> of the <span class="math notranslate nohighlight">\(j\)</span>-invariant with
<span class="math notranslate nohighlight">\(\gamma_2(i) = 12\)</span> as our modular function.
The ring of integers <span class="math notranslate nohighlight">\(O\)</span> of <span class="math notranslate nohighlight">\(K\)</span> is generated by <span class="math notranslate nohighlight">\(\theta = -\frac{1}{2} +
\frac{1}{2}\sqrt{-71}\)</span>, which has minimal polynomial <span class="math notranslate nohighlight">\(X^2+X+18\)</span>.</p>
<p>We start with loading our code and initilizing our quadratic imaginary number
field together with its idèle group. We embed <span class="math notranslate nohighlight">\(K\)</span> in <span class="math notranslate nohighlight">\(\CC\)</span> such that <span class="math notranslate nohighlight">\(\theta\)</span>
lies in the upper half plane.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="kn">from</span> <span class="nn">adeles.all</span> <span class="k">import</span> <span class="o">*</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">];</span> <span class="n">X</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">theta</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">X</span><span class="o">+</span><span class="mi">18</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">4.2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="c1"># Check that we have the correct field QQ(sqrt(-71))</span>
<span class="o">-</span><span class="mi">71</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">O</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span> <span class="c1"># Check that theta indeed generates the ring of integers</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">J</span> <span class="o">=</span> <span class="n">Ideles</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="finding-a-class-invariant">
<h3>Finding a class invariant<a class="headerlink" href="#finding-a-class-invariant" title="Permalink to this headline">¶</a></h3>
<p>Now we want to compute our class invariant. As <span class="math notranslate nohighlight">\(\gamma_2\)</span> is a modular function
of level <span class="math notranslate nohighlight">\(3\)</span> that does not have a pole at <span class="math notranslate nohighlight">\(\theta\)</span>, the theory of complex
multiplication tells us that <span class="math notranslate nohighlight">\(\gamma_2(\theta) \in H_3\)</span>, where <span class="math notranslate nohighlight">\(H_3\)</span> is the ray
class field of <span class="math notranslate nohighlight">\(K\)</span> modulo <span class="math notranslate nohighlight">\(3\)</span>. By explicitly computing the action of
<span class="math notranslate nohighlight">\(Gal(H_3/H)\)</span> on <span class="math notranslate nohighlight">\(\gamma_2(\theta)\)</span>, we will try to find a class invariant of
small height.</p>
<p>The Artin map induces an isomorphism <span class="math notranslate nohighlight">\((O/3O)^*/O^* \to Gal(H_3/H)\)</span>. So we
compute generators of <span class="math notranslate nohighlight">\((O/3O)^*/O^*\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">Omod3</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">quotient_ring</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Omod3star</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">idealstar</span><span class="p">(</span><span class="n">flag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># flag=2 means compute generators</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Omod3star</span><span class="o">.</span><span class="n">gens_values</span><span class="p">()</span>
<span class="p">(</span><span class="o">-</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">theta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>We see that <span class="math notranslate nohighlight">\((O/3O)^*/O^*\)</span> is generated by (the image of) <span class="math notranslate nohighlight">\(\theta-1\)</span>. Hence the
action of <span class="math notranslate nohighlight">\(Gal(H_3/H)\)</span> is determined by the action of the idèle corresponding to
<span class="math notranslate nohighlight">\(\theta-1 \mod 3\)</span>. Let us create this idèle.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">u</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">Omod3</span><span class="p">(</span><span class="n">theta</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span> <span class="n">u</span>
<span class="n">Idèle</span> <span class="k">with</span> <span class="n">values</span><span class="p">:</span>
  <span class="n">infinity_0</span><span class="p">:</span>   <span class="n">CC</span><span class="o">^*</span>
  <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>   <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">U</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">theta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>       <span class="o">-</span><span class="n">theta</span> <span class="o">*</span> <span class="n">U</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">other</span> <span class="n">primes</span><span class="p">:</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">U</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Write <span class="math notranslate nohighlight">\(R_0(u)\)</span> for the finite represented subset of <code class="docutils literal notranslate"><span class="pre">u</span></code>. By Shimura’s
reciprocity law we now have for any <span class="math notranslate nohighlight">\(x \in R_0(u)\)</span> that <span class="math notranslate nohighlight">\(\gamma_2(\theta)^x =
\gamma_2^{g_\theta(x)^{-1}}(\theta)\)</span>, where <span class="math notranslate nohighlight">\(x\)</span> acts via the Artin map and
<span class="math notranslate nohighlight">\(g_\theta: \hat{K}^* \to GL_2(\hat{\QQ})\)</span> denotes Shimura’s connecting
homomorphism.</p>
<p>We compute an <span class="math notranslate nohighlight">\(A \in GL_2^+(\QQ)\)</span> and an approximation to a <span class="math notranslate nohighlight">\(B \in
GL_2(\hat{\ZZ})\)</span> such that there exists an <span class="math notranslate nohighlight">\(x \in R_0(u)\)</span> with <span class="math notranslate nohighlight">\(g_\theta(x)^{-1}
= BA\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">factored_shimura_connecting_homomorphism</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span> <span class="mi">3</span><span class="p">);</span> <span class="n">B</span><span class="p">,</span> <span class="n">A</span>
<span class="p">(</span>
<span class="p">[</span>  <span class="mi">1</span> <span class="n">mod</span> <span class="mi">3</span> <span class="mi">36</span> <span class="n">mod</span> <span class="mi">54</span><span class="p">]</span>  <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span>  <span class="mi">1</span> <span class="n">mod</span> <span class="mi">3</span> <span class="mi">17</span> <span class="n">mod</span> <span class="mi">54</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>As <span class="math notranslate nohighlight">\(A\)</span> is the identity matrix, it acts trivially on <span class="math notranslate nohighlight">\(\gamma_2\)</span>. The action of
<span class="math notranslate nohighlight">\(B\)</span> on <span class="math notranslate nohighlight">\(\gamma_2\)</span> depends only on the reduction <span class="math notranslate nohighlight">\(B_3\)</span> of <span class="math notranslate nohighlight">\(B\)</span> modulo <span class="math notranslate nohighlight">\(3\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">B_3</span> <span class="o">=</span> <span class="n">matrix_modulo</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="n">B_3</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>We factor <span class="math notranslate nohighlight">\(B_3\)</span> as <span class="math notranslate nohighlight">\(B_3 = (1, 0; 0, d) \cdot U\)</span> for some <span class="math notranslate nohighlight">\(U \in SL_2(\ZZ/3\ZZ)\)</span>
and then write <span class="math notranslate nohighlight">\(U\)</span> in terms of the standard generators <span class="math notranslate nohighlight">\(S = (0, -1; -1, 0)\)</span> and
<span class="math notranslate nohighlight">\(T = (1, 1; 0, 1)\)</span> of <span class="math notranslate nohighlight">\(SL_2(\ZZ)\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">d</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">B_3</span><span class="p">);</span> <span class="n">d</span>
<span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">U</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">d</span><span class="p">])</span> <span class="o">*</span> <span class="n">B_3</span><span class="p">;</span> <span class="n">U</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">STs</span> <span class="o">=</span> <span class="n">ST_factor</span><span class="p">(</span><span class="n">U</span><span class="p">);</span> <span class="n">STs</span>
<span class="p">(</span><span class="n">S</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">T</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">S</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
<p>Now <span class="math notranslate nohighlight">\((1, 0; 0, d)\)</span> acts as <span class="math notranslate nohighlight">\(d \in (\ZZ/3\ZZ)^*\)</span> on the Fourier coefficients of
<span class="math notranslate nohighlight">\(\gamma_2\)</span> and one can check that this action is trivial. One can also check
that the action of the standard generators <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(T\)</span> by linear fractional
transformations is given by <span class="math notranslate nohighlight">\(\gamma_2^S = \gamma_2\)</span> and <span class="math notranslate nohighlight">\(\gamma_2^T =
\zeta_3^{-1} \gamma_2\)</span>, with <span class="math notranslate nohighlight">\(\zeta_3 = \exp(2 \pi i/3)\)</span>.</p>
<p>Putting this all together we optain the action of <span class="math notranslate nohighlight">\(B_3\)</span> on <span class="math notranslate nohighlight">\(\gamma_2\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">print_action_on_gamma_2</span><span class="p">(</span><span class="n">B_3</span><span class="p">)</span>
  <span class="n">gamma_2</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_3</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gamma_2</span>
</pre></div>
</div>
<p>As <span class="math notranslate nohighlight">\(\det(B_3) = 2 \in (\ZZ/3\ZZ)^*\)</span>, we also have <span class="math notranslate nohighlight">\(\zeta_3^{B_3} = \zeta_3^2\)</span>.
It follows that <span class="math notranslate nohighlight">\(\zeta_3 \gamma_2\)</span> is left invariant under <span class="math notranslate nohighlight">\(B_3\)</span> and hence, by
the considerations above, <span class="math notranslate nohighlight">\(\alpha := \zeta_3 \gamma_2(\theta)\)</span> is left invariant
under <span class="math notranslate nohighlight">\(Gal(H_3/H)\)</span>, i.e. <span class="math notranslate nohighlight">\(\alpha \in H\)</span>. This is are candidate class invariant.</p>
</div>
<div class="section" id="computing-the-minimal-polynomial">
<h3>Computing the minimal polynomial<a class="headerlink" href="#computing-the-minimal-polynomial" title="Permalink to this headline">¶</a></h3>
<p>We want to compute the minimal polynomial <span class="math notranslate nohighlight">\(h \in K[X]\)</span> of <span class="math notranslate nohighlight">\(\alpha\)</span>. This will
tell us whether or not <span class="math notranslate nohighlight">\(\alpha\)</span> is a class invariant and if so, give us a
(hopefully small) defining equation for the Hilbert class field <span class="math notranslate nohighlight">\(H\)</span> of <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>Write <span class="math notranslate nohighlight">\(C\)</span> for the set of conjugates of <span class="math notranslate nohighlight">\(\alpha\)</span> over <span class="math notranslate nohighlight">\(K\)</span>. Then we have <span class="math notranslate nohighlight">\(h =
\prod_{\beta \in C} (X - \beta)\)</span>, so we want to compute <span class="math notranslate nohighlight">\(C\)</span>. We have <span class="math notranslate nohighlight">\(C =
\{\alpha^\sigma \mid \sigma \in Gal(H/K)\}\)</span>. The Artin map induces an
isomorphism <span class="math notranslate nohighlight">\(Cl \to Gal(H/K)\)</span> for <span class="math notranslate nohighlight">\(Cl\)</span> the ray class group modulo <span class="math notranslate nohighlight">\(1\)</span>. Hence we
first compute <span class="math notranslate nohighlight">\(Cl\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">Cl</span> <span class="o">=</span> <span class="n">ray_class_group</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">Modulus</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">[]));</span> <span class="n">Cl</span>
<span class="n">Narrow</span> <span class="k">class</span> <span class="nc">group</span> <span class="n">of</span> <span class="n">order</span> <span class="mi">7</span> <span class="k">with</span> <span class="n">structure</span> <span class="n">C7</span> <span class="n">of</span> <span class="n">Number</span> <span class="n">Field</span> <span class="ow">in</span> <span class="n">theta</span> <span class="k">with</span> <span class="n">defining</span> <span class="n">polynomial</span> <span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span> <span class="o">+</span> <span class="mi">18</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Cl</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="n">Fractional</span> <span class="n">ideal</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<p>We see that <span class="math notranslate nohighlight">\(Cl\)</span> is generated by the class <span class="math notranslate nohighlight">\([p_2]\)</span> of the prime ideal <span class="math notranslate nohighlight">\(p_2 =
2 O + \theta O\)</span>. We construct the idèle <span class="math notranslate nohighlight">\(v\)</span> corresponding to <span class="math notranslate nohighlight">\([p_2]\)</span>, which
satisfies that the image in <span class="math notranslate nohighlight">\(Cl\)</span> of the represented subset of <span class="math notranslate nohighlight">\(v\)</span> is
<span class="math notranslate nohighlight">\(\{[p_2]\}\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">Cl</span><span class="o">.</span><span class="n">gen</span><span class="p">());</span> <span class="n">v</span>
<span class="n">Idèle</span> <span class="k">with</span> <span class="n">values</span><span class="p">:</span>
  <span class="n">infinity_0</span><span class="p">:</span>   <span class="n">CC</span><span class="o">^*</span>
  <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>   <span class="n">theta</span> <span class="o">*</span> <span class="n">U</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">other</span> <span class="n">primes</span><span class="p">:</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">U</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Now for every <span class="math notranslate nohighlight">\(y \in R_0(v)\)</span> we have <span class="math notranslate nohighlight">\(\alpha^{[p_2]} = \alpha^y\)</span>, both acting
via the Artin map. By Shimura’s reciprocity law, we have <span class="math notranslate nohighlight">\(\alpha^y =
(\zeta_3 \gamma_2)^{g_\theta(y)^{-1}}(\theta)\)</span>. Hence similar to before we
compute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">factored_shimura_connecting_homomorphism</span><span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">v</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="n">B</span><span class="p">,</span> <span class="n">A</span>
<span class="p">(</span>
<span class="p">[</span><span class="mi">8</span> <span class="n">mod</span> <span class="mi">12</span>  <span class="mi">5</span> <span class="n">mod</span> <span class="mi">6</span><span class="p">]</span>  <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span> <span class="n">mod</span> <span class="mi">12</span>  <span class="mi">4</span> <span class="n">mod</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">0</span>   <span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">B_3</span> <span class="o">=</span> <span class="n">matrix_modulo</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="n">B_3</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">d</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">B_3</span><span class="p">);</span> <span class="n">d</span>
<span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">U</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">d</span><span class="p">])</span> <span class="o">*</span> <span class="n">B_3</span><span class="p">;</span> <span class="n">U</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">U_lift</span> <span class="o">=</span> <span class="n">SL2Z</span><span class="p">(</span><span class="n">lift_matrix_to_sl2z</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">list</span><span class="p">(),</span> <span class="mi">3</span><span class="p">));</span> <span class="n">U_lift</span>
<span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">V</span> <span class="o">=</span> <span class="n">U_lift</span> <span class="o">*</span> <span class="n">A</span><span class="p">;</span> <span class="n">V</span>
<span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span>   <span class="mi">0</span>   <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Now we have <span class="math notranslate nohighlight">\(\alpha^{[p_2]} = \zeta_3^d \gamma_2(V \theta)\)</span> where <span class="math notranslate nohighlight">\(V\)</span> acts by
fractional linear transformations. As we know <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(V\)</span> explicitly, we can
numerically evaluate this expression.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">apply_fractional_linear_transformation</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">CC</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="n">d</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span> <span class="o">*</span> <span class="n">gamma_2</span><span class="p">(</span><span class="n">tau</span><span class="p">);</span> <span class="n">beta</span>
<span class="o">-</span><span class="mf">0.0365010349950268</span> <span class="o">+</span> <span class="mf">82.4277120032277</span><span class="o">*</span><span class="n">I</span>
</pre></div>
</div>
<p>This provides us our first conjugate of <span class="math notranslate nohighlight">\(\alpha\)</span>. Of course another one is
obtained easily as well, namely <span class="math notranslate nohighlight">\(\alpha\)</span> itself:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">CC</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma_2</span><span class="p">(</span><span class="n">theta</span><span class="p">);</span> <span class="n">alpha</span>
<span class="o">-</span><span class="mf">6794.32787938645</span> <span class="o">-</span> <span class="mf">3.18323145620525e-12</span><span class="o">*</span><span class="n">I</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">])</span>
</pre></div>
</div>
<p>Note that these two approximations already tell us that <span class="math notranslate nohighlight">\(\alpha\)</span> is indeed a
class invariant: we have <span class="math notranslate nohighlight">\(K \subset K(\alpha) \subset H\)</span> and <span class="math notranslate nohighlight">\(H/K\)</span> is of degree
<span class="math notranslate nohighlight">\(7\)</span>, so the fact that <span class="math notranslate nohighlight">\(\alpha\)</span> has two distinct conjugates over <span class="math notranslate nohighlight">\(K\)</span> implies
<span class="math notranslate nohighlight">\(K(\alpha) = H\)</span>.</p>
<p>To compute the minimal polynomial <span class="math notranslate nohighlight">\(h\)</span> of <span class="math notranslate nohighlight">\(\alpha\)</span> over <span class="math notranslate nohighlight">\(K\)</span> we need
approximations to the other conjugates of <span class="math notranslate nohighlight">\(\alpha\)</span> as well. We compute them the
same way as we did above.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">v</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">Cl</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">**</span><span class="n">n</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">factored_shimura_connecting_homomorphism</span><span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">v</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">B_3</span> <span class="o">=</span> <span class="n">matrix_modulo</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">d</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">B_3</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">U</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">d</span><span class="p">])</span> <span class="o">*</span> <span class="n">B_3</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">U_lift</span> <span class="o">=</span> <span class="n">SL2Z</span><span class="p">(</span><span class="n">lift_matrix_to_sl2z</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">list</span><span class="p">(),</span> <span class="mi">3</span><span class="p">))</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">V</span> <span class="o">=</span> <span class="n">U_lift</span> <span class="o">*</span> <span class="n">A</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">tau</span> <span class="o">=</span> <span class="n">apply_fractional_linear_transformation</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">C</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">CC</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="n">d</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span> <span class="o">*</span> <span class="n">gamma_2</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span>
<span class="o">....</span><span class="p">:</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">C</span>
<span class="p">{</span><span class="o">-</span><span class="mf">6794.32787938645</span> <span class="o">-</span> <span class="mf">3.18323145620525e-12</span><span class="o">*</span><span class="n">I</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">0.0365010349950410</span> <span class="o">-</span> <span class="mf">82.4277120032278</span><span class="o">*</span><span class="n">I</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">0.0365010349950268</span> <span class="o">+</span> <span class="mf">82.4277120032277</span><span class="o">*</span><span class="n">I</span><span class="p">,</span>
 <span class="mf">6.37327655672568</span> <span class="o">-</span> <span class="mf">3.45837454755243</span><span class="o">*</span><span class="n">I</span><span class="p">,</span>
 <span class="mf">6.37327655672568</span> <span class="o">+</span> <span class="mf">3.45837454755240</span><span class="o">*</span><span class="n">I</span><span class="p">,</span>
 <span class="mf">18.3271641714828</span> <span class="o">-</span> <span class="mf">6.03184683115439</span><span class="o">*</span><span class="n">I</span><span class="p">,</span>
 <span class="mf">18.3271641714828</span> <span class="o">+</span> <span class="mf">6.03184683115437</span><span class="o">*</span><span class="n">I</span><span class="p">}</span>
</pre></div>
</div>
<p>From these approximations we compute an approximation to <span class="math notranslate nohighlight">\(h\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">h_approx</span> <span class="o">=</span> <span class="n">prod</span><span class="p">([(</span><span class="n">X</span> <span class="o">-</span> <span class="n">conjugate</span><span class="p">)</span> <span class="k">for</span> <span class="n">conjugate</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]);</span> <span class="n">h_approx</span>
<span class="n">X</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="p">(</span><span class="mf">6745.00000000003</span> <span class="o">+</span> <span class="mf">3.32534000335727e-12</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">327467.000000002</span> <span class="o">+</span> <span class="mf">9.31322574615479e-10</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="p">(</span><span class="mf">5.18571150000002e7</span> <span class="o">-</span> <span class="mf">2.98023223876953e-8</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.31929975100002e9</span> <span class="o">+</span> <span class="mf">2.35438346862793e-6</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="mf">4.12645825130003e10</span> <span class="o">-</span> <span class="mf">0.0000805854797363281</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.07873876442003e11</span> <span class="o">+</span> <span class="mf">0.00102996826171875</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">X</span> <span class="o">+</span> <span class="mf">9.03568991567007e11</span> <span class="o">-</span> <span class="mf">0.00415039062500000</span><span class="o">*</span><span class="n">I</span>
</pre></div>
</div>
<p>From these coefficients we clearly recognize an integral polynomial, with
entries in <span class="math notranslate nohighlight">\(\ZZ\)</span> even; the imaginary parts of <span class="math notranslate nohighlight">\(h_{approx}\)</span> are almost zero:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="nb">all</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.01</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">h_approx</span><span class="p">])</span>
<span class="kc">True</span>
</pre></div>
</div>
<p>The corresponding integral polynomial is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">h</span> <span class="o">=</span> <span class="n">R</span><span class="p">([</span><span class="n">ZZ</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">())</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">h_approx</span><span class="p">]);</span> <span class="n">h</span>
<span class="n">X</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">6745</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">327467</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">51857115</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2319299751</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">41264582513</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">307873876442</span><span class="o">*</span><span class="n">X</span> <span class="o">+</span> <span class="mi">903568991567</span>
</pre></div>
</div>
<p>We conclude that for the polynomial <span class="math notranslate nohighlight">\(h\)</span> above, we have <span class="math notranslate nohighlight">\(H \cong K[X]/(f)\)</span>.
Note that this polynomial is significantly smaller than the “standard” Hilbert
class polynomial:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_polynomial</span><span class="p">()</span>
<span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">313645809715</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3091990138604570</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">98394038810047812049302</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">823534263439730779968091389</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5138800366453976780323726329446</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">425319473946139603274605151187659</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">737707086760731113357714241006081263</span>
</pre></div>
</div>
<p>The above polynomial is obtained as the minimial polynomial of <span class="math notranslate nohighlight">\(j(\theta)\)</span> for
<span class="math notranslate nohighlight">\(j\)</span> the <span class="math notranslate nohighlight">\(j\)</span>-invariant.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Our polynomial <span class="math notranslate nohighlight">\(h\)</span> above is equal to the one in [GS1998], except for the
sign at <span class="math notranslate nohighlight">\(X^3\)</span>, indicating a typo in [GS1998].</p>
</div>
</div>
</div>
<div class="section" id="example-2">
<h2>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h2>
<p>Our second example involves the same field <span class="math notranslate nohighlight">\(K = \QQ(\sqrt{-71})\)</span>, but a
different modular function: we take Weber’s <span class="math notranslate nohighlight">\(\mathfrak{f}_2\)</span> modular function of
level <span class="math notranslate nohighlight">\(48\)</span> (cf. <code class="xref py py-func docutils literal notranslate"><span class="pre">modular.weber_f2()</span></code>).</p>
<p>Because <span class="math notranslate nohighlight">\(\mathfrak{f}_2\)</span> is of level <span class="math notranslate nohighlight">\(48\)</span>, we compute generators of
<span class="math notranslate nohighlight">\((O/48O)^*/O^*\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">Omod48</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">quotient_ring</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Omod48star</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span><span class="o">.</span><span class="n">idealstar</span><span class="p">(</span><span class="n">flag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Omod48star</span><span class="o">.</span><span class="n">gens_values</span><span class="p">()</span>
<span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">13</span><span class="p">,</span>
 <span class="mi">12</span><span class="o">*</span><span class="n">theta</span> <span class="o">-</span> <span class="mi">23</span><span class="p">,</span>
 <span class="mi">6</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">19</span><span class="p">,</span>
 <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">13</span><span class="p">,</span>
 <span class="o">-</span><span class="mi">16</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
 <span class="mi">16</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">17</span><span class="p">)</span>
</pre></div>
</div>
<p>For each of these generators, we construct the corresponding idèle and compute
its action on <span class="math notranslate nohighlight">\(\mathfrak{f}_2\)</span> and <span class="math notranslate nohighlight">\(\zeta_{48} = \exp(2 \pi i / 48)\)</span> via
Shimura’s connecting homomorphism.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Omod48star</span><span class="o">.</span><span class="n">gens_values</span><span class="p">():</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">u</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">Omod48</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">factored_shimura_connecting_homomorphism</span><span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">u</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">B_48</span> <span class="o">=</span> <span class="n">matrix_modulo</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">C_48</span> <span class="o">=</span> <span class="n">B_48</span> <span class="o">*</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Action of </span><span class="si">{}</span><span class="s2">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">print_action_on_weber_f2</span><span class="p">(</span><span class="n">C_48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  zeta_48 ]--&gt; zeta_48^</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">B_48</span><span class="p">)))</span>
<span class="o">....</span><span class="p">:</span>
<span class="n">Action</span> <span class="n">of</span> <span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">13</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">84</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">13</span>
<span class="n">Action</span> <span class="n">of</span> <span class="mi">12</span><span class="o">*</span><span class="n">theta</span> <span class="o">-</span> <span class="mi">23</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">84</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">13</span>
<span class="n">Action</span> <span class="n">of</span> <span class="mi">6</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">19</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">66</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">31</span>
<span class="n">Action</span> <span class="n">of</span> <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">13</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">18</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">31</span>
<span class="n">Action</span> <span class="n">of</span> <span class="o">-</span><span class="mi">16</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">80</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">17</span>
<span class="n">Action</span> <span class="n">of</span> <span class="mi">16</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">17</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">32</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">17</span>
</pre></div>
</div>
<p>Above we use the fact that the computed matrices <span class="math notranslate nohighlight">\(A\)</span> all lie in <span class="math notranslate nohighlight">\(SL_2(\ZZ)\)</span>,
because Shimura’s connecting homomorphism maps <span class="math notranslate nohighlight">\(\hat{O}^*\)</span> to <span class="math notranslate nohighlight">\(GL_2(\hat{\ZZ})\)</span>.
Let us display the computed action above a bit more clearly in the following
table. For <span class="math notranslate nohighlight">\(k \in \ZZ_{&gt;0}\)</span>, we write <span class="math notranslate nohighlight">\(\zeta_k = \exp(2 \pi i / k)\)</span>.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 33%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(x\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\zeta_{48}^x/\zeta_{48}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\mathfrak{f}_2^x/\mathfrak{f}_2\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(-12 \theta + 13\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_4^3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_4\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(12 \theta - 23\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_4^3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_4\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(6 \theta + 19\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_8^3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_8^5\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(-6 \theta + 13\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_8^3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_8^5\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(-16 \theta + 1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_3^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_3\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(16 \theta + 17\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_3^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_3\)</span></p></td>
</tr>
</tbody>
</table>
<p>We see that <span class="math notranslate nohighlight">\(\zeta_{48} \mathfrak{f}_2\)</span> is left invariant under all generators.
Hence <span class="math notranslate nohighlight">\(\alpha = \zeta_{48} \mathfrak{f}_2(\theta)\)</span> is left invariant under
<span class="math notranslate nohighlight">\(Gal(H_{48}/H)\)</span> and so <span class="math notranslate nohighlight">\(\alpha \in H\)</span>.</p>
<p>We compute numerical approximations to the conjugates of <span class="math notranslate nohighlight">\(\alpha\)</span> over <span class="math notranslate nohighlight">\(K\)</span> and
construct an approximation <span class="math notranslate nohighlight">\(h_{approx}\)</span> to the minimal polynomial <span class="math notranslate nohighlight">\(h\)</span> of
<span class="math notranslate nohighlight">\(\alpha\)</span> over <span class="math notranslate nohighlight">\(K\)</span>. This time we need more than the standard <span class="math notranslate nohighlight">\(53\)</span>-bits of
precision and so we use <span class="math notranslate nohighlight">\(100\)</span> bits.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">CC</span> <span class="o">=</span> <span class="n">ComplexField</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Cl</span><span class="p">:</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">factored_shimura_connecting_homomorphism</span><span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">B_48</span> <span class="o">=</span> <span class="n">matrix_modulo</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">d</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">B_48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">U</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">d</span><span class="p">])</span> <span class="o">*</span> <span class="n">B_48</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">U_lift</span> <span class="o">=</span> <span class="n">SL2Z</span><span class="p">(</span><span class="n">lift_matrix_to_sl2z</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">list</span><span class="p">(),</span> <span class="mi">48</span><span class="p">))</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">V</span> <span class="o">=</span> <span class="n">U_lift</span> <span class="o">*</span> <span class="n">A</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">tau</span> <span class="o">=</span> <span class="n">apply_fractional_linear_transformation</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">sign_f2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span> <span class="o">%</span> <span class="mi">8</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">C</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">CC</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span><span class="o">**</span><span class="n">d</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span> <span class="o">*</span> <span class="n">sign_f2</span><span class="o">*</span><span class="n">weber_f2</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">h_approx</span> <span class="o">=</span> <span class="n">prod</span><span class="p">([(</span><span class="n">X</span> <span class="o">-</span> <span class="n">conjugate</span><span class="p">)</span> <span class="k">for</span> <span class="n">conjugate</span> <span class="ow">in</span> <span class="n">C</span><span class="p">])</span>
</pre></div>
</div>
<p>Again the coefficients of <span class="math notranslate nohighlight">\(h_{approx}\)</span> all have imaginary part allmost zero:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="nb">all</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1e-20</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">h_approx</span><span class="p">])</span>
<span class="kc">True</span>
</pre></div>
</div>
<p>We recognize the (very small) minimal polynomial <span class="math notranslate nohighlight">\(h \in \ZZ[X]\)</span> of <span class="math notranslate nohighlight">\(\alpha\)</span> over
<span class="math notranslate nohighlight">\(K\)</span> as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">h</span> <span class="o">=</span> <span class="n">R</span><span class="p">([</span><span class="n">ZZ</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">())</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">h_approx</span><span class="p">]);</span> <span class="n">h</span>
<span class="n">X</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="n">X</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="n">X</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">X</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">X</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This is the same polynomial found in [GS1998].</p>
</div>
<div class="section" id="example-3">
<h2>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h2>
<p>Our third and last example involves the field <span class="math notranslate nohighlight">\(K = \QQ(\sqrt{-471})\)</span> whose ring
of integers is generated by <span class="math notranslate nohighlight">\(\theta = -\frac{1}{2} + \frac{1}{2}\sqrt{-471}\)</span>,
which has minimial polynomial <span class="math notranslate nohighlight">\(X^2 + X + 118\)</span>. This example uses Weber’s modular
function <span class="math notranslate nohighlight">\(\mathfrak{f}_2\)</span> (cf. <code class="xref py py-func docutils literal notranslate"><span class="pre">modular.weber_f2()</span></code>).
We start by constructing <span class="math notranslate nohighlight">\(K\)</span> (embedded into <span class="math notranslate nohighlight">\(\CC\)</span> with <span class="math notranslate nohighlight">\(\theta\)</span> on the positive
imaginary axis) and its idèle group.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">theta</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span> <span class="o">+</span> <span class="mi">118</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">10.9</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="o">-</span><span class="mi">471</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">O</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">J</span> <span class="o">=</span> <span class="n">Ideles</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we compute the action of <span class="math notranslate nohighlight">\(Gal(H_{48}/H)\)</span> on <span class="math notranslate nohighlight">\(\mathfrak{f}\)</span> and
<span class="math notranslate nohighlight">\(\zeta_{48}\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">Omod48</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">quotient</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Omod48star</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span><span class="o">.</span><span class="n">idealstar</span><span class="p">(</span><span class="n">flag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Omod48star</span><span class="o">.</span><span class="n">gens_values</span><span class="p">():</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">u</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">Omod48</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">factored_shimura_connecting_homomorphism</span><span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">u</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">B_48</span> <span class="o">=</span> <span class="n">matrix_modulo</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">C_48</span> <span class="o">=</span> <span class="n">B_48</span> <span class="o">*</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Action of </span><span class="si">{}</span><span class="s2">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">print_action_on_weber_f2</span><span class="p">(</span><span class="n">C_48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  zeta_48 ]--&gt; zeta_48^</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">B_48</span><span class="p">)))</span>
<span class="o">....</span><span class="p">:</span>
<span class="n">Action</span> <span class="n">of</span> <span class="mi">4</span><span class="o">*</span><span class="n">theta</span> <span class="o">-</span> <span class="mi">23</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">124</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">37</span>
<span class="n">Action</span> <span class="n">of</span> <span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">13</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">84</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">13</span>
<span class="n">Action</span> <span class="n">of</span> <span class="o">-</span><span class="mi">24</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="mi">17</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">24</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">25</span>
<span class="n">Action</span> <span class="n">of</span> <span class="mi">6</span><span class="o">*</span><span class="n">theta</span> <span class="o">-</span> <span class="mi">5</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">18</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">31</span>
<span class="n">Action</span> <span class="n">of</span> <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">theta</span> <span class="o">-</span> <span class="mi">11</span><span class="p">:</span>
  <span class="n">f2</span>    <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta48</span><span class="o">^</span><span class="mi">66</span><span class="o">*</span><span class="n">f2</span>
  <span class="n">zeta_48</span> <span class="p">]</span><span class="o">--&gt;</span> <span class="n">zeta_48</span><span class="o">^</span><span class="mi">31</span>
</pre></div>
</div>
<p>We summarize these results in the following table.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 33%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(x\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\zeta_{48}^x/\zeta_{48}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\mathfrak{f}_2^x/\mathfrak{f}_2\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(4 \theta - 23\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_{12}^{31}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_4^3\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(-12 \theta - 13\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_4^3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_4\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(-24 \theta + 17\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(-6 \theta - 11\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_8^3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\zeta_8^5\)</span></p></td>
</tr>
</tbody>
</table>
<p>We see that <span class="math notranslate nohighlight">\(\zeta_{16} \mathfrak{f}_2^3\)</span> is left invariant under all
generators. Hence <span class="math notranslate nohighlight">\(\alpha = \zeta_{16} \mathfrak{f}_2^3(\theta) \in H\)</span>, as it
is left invariant under <span class="math notranslate nohighlight">\(Gal(H_{48}/H)\)</span>.</p>
<p>We compute the minimal polynomial of <span class="math notranslate nohighlight">\(\alpha\)</span> over <span class="math notranslate nohighlight">\(K\)</span> as before.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">Cl</span> <span class="o">=</span> <span class="n">ray_class_group</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">Modulus</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">[]))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Cl</span><span class="p">:</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">factored_shimura_connecting_homomorphism</span><span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">B_48</span> <span class="o">=</span> <span class="n">matrix_modulo</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">d</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">B_48</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">U</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">d</span><span class="p">])</span> <span class="o">*</span> <span class="n">B_48</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">U_lift</span> <span class="o">=</span> <span class="n">SL2Z</span><span class="p">(</span><span class="n">lift_matrix_to_sl2z</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">list</span><span class="p">(),</span> <span class="mi">48</span><span class="p">))</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">V</span> <span class="o">=</span> <span class="n">U_lift</span> <span class="o">*</span> <span class="n">A</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">tau</span> <span class="o">=</span> <span class="n">apply_fractional_linear_transformation</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">sign_f2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span> <span class="o">%</span> <span class="mi">8</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span>
<span class="o">....</span><span class="p">:</span>     <span class="n">C</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">CC</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">**</span><span class="n">d</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span> <span class="o">*</span> <span class="n">sign_f2</span><span class="o">*</span><span class="n">weber_f2</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="o">....</span><span class="p">:</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">h_approx</span> <span class="o">=</span> <span class="n">prod</span><span class="p">([(</span><span class="n">X</span> <span class="o">-</span> <span class="n">conjugate</span><span class="p">)</span> <span class="k">for</span> <span class="n">conjugate</span> <span class="ow">in</span> <span class="n">C</span><span class="p">])</span>
</pre></div>
</div>
<p>Again the imaginary parts of the coefficients of <span class="math notranslate nohighlight">\(h_{approx}\)</span> lie near zero:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="nb">all</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1e-8</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">h_approx</span><span class="p">])</span>
<span class="kc">True</span>
</pre></div>
</div>
<p>And we obtain the polynomial</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">h</span> <span class="o">=</span> <span class="n">R</span><span class="p">([</span><span class="n">ZZ</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">())</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">h_approx</span><span class="p">]);</span> <span class="n">h</span>
<span class="n">X</span><span class="o">^</span><span class="mi">16</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">15</span> <span class="o">+</span> <span class="mi">62</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="mi">106</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">382</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">942</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">4756</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">9629</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">18987</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">22281</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">36601</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">44222</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">60470</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">29217</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4085</span><span class="o">*</span><span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1775</span><span class="o">*</span><span class="n">X</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
<p>for which we have <span class="math notranslate nohighlight">\(H \cong K[X]/(h)\)</span>. Again this polynomial is a lot smaller
than the one obtained from the <span class="math notranslate nohighlight">\(j\)</span>-invariant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_polynomial</span><span class="p">()</span>
<span class="n">x</span><span class="o">^</span><span class="mi">16</span> <span class="o">+</span> <span class="mi">407778921764211975870138302520</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">15</span> <span class="o">+</span> <span class="mi">3038670026466389034174375356410562377980</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">+</span> <span class="mi">166283649035293163892223950995038214787614607187102726207320</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">1239105834253481690958131671057246233275628887838001822867346860887030</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">44797353340751299573712910256682503747536265367214881959872320870897863091154</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">810567263265620329576875533282472560320845728181072489292583387055671192443893737892</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">428763471339093213649510095829304307139166477766352360735556993753303248962236501430574245</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">551473043901993149280796896099822581402624627798883643717202518930460973073901757847470313386009</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">2173004307152659310409985921885398494009923550238354733945001965717708945263362426633491401144494415</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">4082391158364853819568696794182067917024971322990393222310715567465711801418257301213552484408773408627183</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">33809233950512659615781751039981915421672207004165577744326580464904519862900013603681132637581479960297858710</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">192318969548058851552756744664691959935081474974687796736508706834400679745833139489829884550400808870445882886914</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">412114501584451807406990682227863134909939929331144168823710914342965136030803289793803741657821243637047663904695587</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">380823091101794086983979218290110745354995985354657257935542041508354314680412729764091385489540085125805257839099389531</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">169796844561266720706774333605228207016816015396255852564580389382199302145429348975497662909496897082101714028727358256787</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">91940638625558460160208745666251339633209006005918537611868314018544115192949608574570709846273095191663462730164649941895793</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In our examples it was the case that the obtained polynomial actually lied
in <span class="math notranslate nohighlight">\(\ZZ[X]\)</span>. In general one can recognize polynomials in <span class="math notranslate nohighlight">\(K[X]\)</span> from
numerical appoximations using the LLL-algorithm. One can for example use
the function <code class="docutils literal notranslate"><span class="pre">recognize_polynomial()</span></code> in <code class="docutils literal notranslate"><span class="pre">polynomials.sage</span></code> at
<a class="reference external" href="https://github.com/mstreng/recip/blob/master/recip/polynomials.sage">https://github.com/mstreng/recip/blob/master/recip/polynomials.sage</a>.</p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Hilbert Class Field Computations</a><ul>
<li><a class="reference internal" href="#example-1">Example 1</a><ul>
<li><a class="reference internal" href="#finding-a-class-invariant">Finding a class invariant</a></li>
<li><a class="reference internal" href="#computing-the-minimal-polynomial">Computing the minimal polynomial</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-2">Example 2</a></li>
<li><a class="reference internal" href="#example-3">Example 3</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="shimura.html"
                        title="previous chapter">Shimura Connecting Homomorphism</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/hilbert.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="shimura.html" title="Shimura Connecting Homomorphism"
             >previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="index.html">Home</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Hilbert Class Field Computations</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Mathé Hertogh.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>